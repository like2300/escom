#!/bin/bash\n\necho \"🚀 Starting ESCOM Production Deployment\"\necho \"========================================\"\n\n# Set environment variables for production\nexport DJANGO_SETTINGS_MODULE=schoolv2.settings_production_whitenoise\n\necho \"🔧 Setting up environment...\"\necho \"DJANGO_SETTINGS_MODULE: $DJANGO_SETTINGS_MODULE\"\n\n# Make sure we're in the correct directory\ncd \"/Users/omerlinks/Downloads/video/POUR ROKOK MIV/alma/schoolv2\"\n\necho \"📦 Installing dependencies...\"\nif [ -f \"requirements.txt\" ]; then\n    pip install -r requirements.txt\nelse\n    echo \"❌ requirements.txt not found!\"\n    exit 1\nfi\n\necho \"🔍 Checking for Django configuration issues...\"\npython manage.py check --deploy\n\nif [ $? -ne 0 ]; then\n    echo \"❌ Django check failed, please fix issues before deployment\"\n    exit 1\nfi\n\necho \"🗄️  Running database migrations...\"\npython manage.py migrate --noinput\n\nif [ $? -ne 0 ]; then\n    echo \"❌ Database migrations failed\"\n    exit 1\nfi\n\necho \"🎨 Collecting static files for production using WhiteNoise...\"\npython manage.py collectstatic --noinput --clear\n\nif [ $? -ne 0 ]; then\n    echo \"❌ Static files collection failed\"\n    exit 1\nfi\n\necho \"📊 Verifying static files...\"\nSTATIC_DIR=\"staticfiles\"\nif [ -d \"$STATIC_DIR\" ] && [ \"$(ls -A $STATIC_DIR)\" ]; then\n    echo \"✅ Static files directory exists and has content\"\n    STATIC_COUNT=$(find \"$STATIC_DIR\" -type f | wc -l)\n    echo \"📊 Total static files: $STATIC_COUNT\"\n    \n    # Show some example files\n    echo \"📄 Sample static files:\"\n    find \"$STATIC_DIR\" -type f | head -10\nelse\n    echo \"❌ Static files directory is empty or doesn't exist\"\n    exit 1\nfi\n\necho \"✅ Deployment completed successfully!\"\necho \"\"\necho \"📋 Next steps for production server:\"\necho \"1. The application is configured with WhiteNoise to serve static files\"\necho \"2. For better performance, configure your web server (nginx/Apache) to serve /static/ directly:\"\necho \"   location /static/ {\"\necho \"       alias $(pwd)/staticfiles/;\"\necho \"       expires 30d;\"\necho \"       add_header Cache-Control \\\"public, immutable\\\";\"\necho \"   }\"\necho \"\"\necho \"3. Run the application with Gunicorn:\"\necho \"   gunicorn schoolv2.wsgi:application --bind 0.0.0.0:8000\"\necho \"\"\necho \"4. Update ALLOWED_HOSTS in settings to your actual domain\"\necho \"\"\necho \"💡 For maximum performance, use the nginx configuration above and\"\necho \"   run with: DJANGO_SETTINGS_MODULE=schoolv2.settings_production gunicorn ...\"\necho \"\"\necho \"🎉 ESCOM Production Deployment Complete!\"\necho \"💡 Static files are now properly configured for production!\"